.PHONY = all clean help

TARGET = albatross
SRCDIR = src
INCDIR = include

SRC = $(wildcard $(SRCDIR)/*.cpp)
OBJ = $(SRC:.cpp=.o)

LDLIBS = -lntl -lgmp -lm -lcryptopp -lsqlite3
CXXFLAGS = -Wall -Wextra -O3 -std=c++11 -pthread -march=native
INCLUDES = -I$(INCDIR)

all: $(TARGET)

$(TARGET): $(OBJ)
	$(CXX) $(CXXFLAGS) -o $@ $^ $(LDLIBS)

%.o: %.cpp
	$(CXX) $(CXXFLAGS) -c -o $@ $^ $(INCLUDES)

main.o: $(wildcare $(INCDIR)/*.hpp)
hash.o: hash.hpp func.hpp
proofs.o: proofs.hpp hash.hpp
randomness_extraction.o: randomness_extraction.hpp func.hpp
pvss.o: pvss.hpp proofs.hpp func.hpp

clean:
	@$(RM) $(OBJ) *~ $(TARGET)

help:
			@echo "Usage:"
			@echo "  make [all]    Build the software"
			@echo "  make clean    Remove all files generated by make"
			@echo "  make help     Display the main targets of this Makefile with a short description"
